# 增长建模分析计划 (XGBoost & Qini Curve)\n\n## 1. 分析目标\n\n本分析旨在运用机器学习方法（XGBoost）和因果推断技术（Uplift Modeling），基于现有用户特征数据，构建一个增长模型。该模型的核心目标是：\n1.  识别对不同裂变策略响应差异最大的用户群体。\n2.  选出最有可能因裂变策略而发生转化行为（即“被策反”或“墙头草”用户）的目标用户。\n3.  通过 Qini 曲线量化评估不同裂变策略的增量效果，为精准营销和资源优化提供数据驱动的决策支持。\n\n## 2. 数据准备\n\n- **数据源**: `裂变.csv`\n- **关键字段**:\n  - **用户特征**: `设备`, `城市类型`, `R值`, `M值`。\n  - **历史行为**: `曾助力`, `曾拼团`, `曾推荐`。\n  - **实验变量**: `裂变类型` (用户当前接触的策略: 助力砍价, 拼团狂买, 无裂变页面)。\n  - **目标变量**: `是否转化` (用户最终是否购买)。\n\n## 3. 分析思路与步骤\n\n### 3.1 数据预处理与特征工程\n-   **数据清洗**: 检查并处理缺失值、异常值。\n-   **特征编码**: 对分类变量 (`设备`, `城市类型`, `裂变类型`) 进行 One-Hot Encoding (哑变量处理)。\n-   **构造标签**: 这是 Uplift Modeling 的关键。根据用户的历史行为和当前看到的裂变策略，将用户分为四类：\n    -   **TR (Treatment Responder)**: 看到裂变页面且转化的用户 (例如：看到“助力砍价”且购买)。\n    -   **TN (Treatment Non-Responder)**: 看到裂变页面但未转化的用户 (例如：看到“助力砍价”但未购买)。\n    -   **CR (Control Responder)**: 看到无裂变页面且转化的用户 (例如：看到“无裂变页面”且购买)。\n    -   **CN (Control Non-Responder)**: 看到无裂变页面但未转化的用户 (例如：看到“无裂变页面”但未购买)。\n-   **数据集划分**: 将数据分为训练集和测试集。\n\n### 3.2 Uplift Model 构建 (XGBoost)\n-   **模型选择**: 使用 `XGBoost` 的 `XGBClassifier`。这是一个多分类问题，目标是预测用户属于 TR, TN, CR, CN 四类中的哪一类。\n-   **特征输入**: 使用经过预处理的用户特征（不包括 `是否转化` 和 `裂变类型`）。\n-   **目标输出**: 使用上一步构造的四分类标签。\n-   **模型训练**: 在训练集上拟合 XGBoost 模型。\n-   **模型预测**: 在测试集上预测每个用户属于四类的概率 $P_{TR}, P_{TN}, P_{CR}, P_{CN}$。\n\n### 3.3 增量分数 (Uplift Score) 计算\n-   对于测试集中的每个用户，利用模型预测出的四类概率，计算其**增量分数 (Uplift Score)**。\n-   增量分数的计算公式为：\n    $$\n    \text{Uplift Score} = \frac{P_{TR}}{P_{TR}+P_{TN}} + \frac{P_{CN}}{P_{CN}+P_{CR}} - \frac{P_{TN}}{P_{TR}+P_{TN}} - \frac{P_{CR}}{P_{CN}+P_{CR}}\n    $$\n    这个公式衡量了用户在看到裂变页面 vs 看到无裂变页面时，转化行为的净差异。\n\n### 3.4 Qini Curve 可视化与分析\n-   **数据排序**: 根据计算出的**增量分数**对测试集用户进行降序排序。\n-   **分位计算**: 按照排序后的用户比例（例如，前 10%，前 20%，...，100%），逐步累加计算：\n    -   **累积转化增益**: $(\text{被策反的TR数} - \text{策反失败的CR数}) / (\text{总TR数} + \text{总CR数})$。\n-   **绘制曲线**:\n    -   **X轴**: 累积用户比例 (% of Population)。\n    -   **Y轴**: 累积转化增益 (Uplift Gain)。\n    -   绘制实际模型的 Qini 曲线。\n    -   绘制随机猜测模型的 Qini 曲线（一条穿过原点的直线）。\n-   **效果评估**: 两条曲线之间的面积差越大，说明模型的增量捕捉能力越强。\n-   **策略比较**: 对“助力砍价”和“拼团狂买”分别建立 Uplift 模型并绘制 Qini 曲线，进行直观比较。\n\n## 4. 预期结果\n\n-   得到一个能够预测用户对裂变策略响应差异的 XGBoost Uplift 模型。\n-   计算出每个用户的增量分数，实现用户的价值分层。\n-   通过 Qini 曲线，定量比较“助力砍价”和“拼团狂买”的净增长效果，并识别出最优的策略。\n-   为后续的精准营销活动提供可落地的目标用户清单和策略建议。\n\n## 5. 工具\n\n- Python (pandas, scikit-learn/xgboost, matplotlib, seaborn)